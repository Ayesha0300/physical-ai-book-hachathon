<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="ROS 2 Communication Primitives">
  <title>ROS 2 Communication Primitives</title>
  <desc>This diagram shows the three main communication patterns in ROS 2: Topics, Services, and Actions. Topics are shown as continuous data streams (green), Services as request-response interactions (red), and Actions as long-running goals with feedback (blue). Each section illustrates how these patterns work with examples.</desc>
  <style>
    .title { font: bold 18px sans-serif; fill: #333; }
    .subtitle { font: 14px sans-serif; fill: #555; }
    .topic { fill: #e8f4e8; stroke: #2e8555; stroke-width: 2; rx: 8; ry: 8; }
    .service { fill: #ffe0e0; stroke: #a62c2c; stroke-width: 2; rx: 8; ry: 8; }
    .action { fill: #e0e8ff; stroke: #2c5ca6; stroke-width: 2; rx: 8; ry: 8; }
    .arrow { stroke: #666; stroke-width: 2; marker-end: url(#arrowhead); }
    .label { font: 12px sans-serif; fill: #333; }
    .data { font: 10px sans-serif; fill: #555; }
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7"
      refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="250" y="30" class="title">ROS 2 Communication Primitives</text>

  <!-- Topics Section -->
  <rect x="50" y="60" width="700" height="150" class="topic"/>
  <text x="60" y="80" class="subtitle">Topics: Continuous Data Streams</text>

  <!-- Topic Example -->
  <rect x="80" y="100" width="100" height="40" class="topic"/>
  <text x="95" y="125" class="label">Camera</text>
  <text x="90" y="140" class="data">Publisher</text>

  <line x1="180" y1="120" x2="250" y2="120" class="arrow"/>
  <text x="200" y="115" class="data">/camera/image_raw</text>

  <rect x="250" y="90" width="100" height="25" class="topic"/>
  <text x="265" y="110" class="label">Object</text>
  <text x="260" y="125" class="data">Detector</text>

  <rect x="250" y="125" width="100" height="25" class="topic"/>
  <text x="265" y="145" class="label">Navigator</text>

  <text x="80" y="170" class="data">• Publish-Subscribe pattern</text>
  <text x="80" y="185" class="data">• Asynchronous, continuous</text>
  <text x="80" y="200" class="data">• Sensor data, state updates</text>

  <!-- Services Section -->
  <rect x="50" y="230" width="700" height="150" class="service"/>
  <text x="60" y="250" class="subtitle">Services: Request-Response Interactions</text>

  <!-- Service Example -->
  <rect x="80" y="270" width="100" height="40" class="service"/>
  <text x="95" y="295" class="label">Navigation</text>
  <text x="95" y="310" class="data">Client</text>

  <line x1="180" y1="290" x2="250" y2="290" class="arrow"/>
  <text x="190" y="285" class="data">"Go to (x=5, y=3)"</text>

  <rect x="250" y="270" width="100" height="40" class="service"/>
  <text x="265" y="295" class="label">Navigation</text>
  <text x="270" y="310" class="data">Server</text>

  <line x1="300" y1="310" x2="300" y2="340" class="arrow"/>
  <text x="310" y="325" class="data">Processing</text>

  <line x1="300" y1="340" x2="250" y2="340" class="arrow"/>
  <line x1="250" y1="340" x2="250" y2="330" class="arrow"/>
  <text x="260" y="335" class="data">"Success"</text>

  <text x="80" y="360" class="data">• Request-Response pattern</text>
  <text x="80" y="375" class="data">• Synchronous, blocking</text>
  <text x="80" y="390" class="data">• Configuration, queries</text>

  <!-- Actions Section -->
  <rect x="50" y="400" width="700" height="180" class="action"/>
  <text x="60" y="420" class="subtitle">Actions: Long-Running Goals with Feedback</text>

  <!-- Action Example -->
  <rect x="80" y="440" width="100" height="40" class="action"/>
  <text x="95" y="465" class="label">Arm</text>
  <text x="85" y="480" class="data">Controller</text>

  <line x1="180" y1="460" x2="250" y2="460" class="arrow"/>
  <text x="190" y="455" class="data">"Grasp object at (x, y, z)"</text>

  <rect x="250" y="440" width="100" height="40" class="action"/>
  <text x="265" y="465" class="label">Arm</text>
  <text x="260" y="480" class="data">Executor</text>

  <line x1="300" y1="480" x2="300" y2="510" class="arrow"/>
  <text x="310" y="495" class="data">Processing</text>

  <line x1="300" y1="510" x2="250" y2="510" class="arrow"/>
  <line x1="250" y1="510" x2="250" y2="500" class="arrow"/>
  <text x="260" y="505" class="data">"Moving to approach"</text>

  <line x1="250" y1="510" x2="180" y2="510" class="arrow"/>
  <line x1="180" y1="510" x2="180" y2="490" class="arrow"/>
  <text x="190" y="505" class="data">"Approaching object"</text>

  <line x1="180" y1="510" x2="180" y2="530" class="arrow"/>
  <text x="190" y="525" class="data">"Gripper closing"</text>

  <line x1="180" y1="530" x2="80" y2="530" class="arrow"/>
  <line x1="80" y1="530" x2="80" y2="490" class="arrow"/>
  <text x="90" y="525" class="data">"Grasp successful"</text>

  <text x="80" y="550" class="data">• Goal-Feedback-Result pattern</text>
  <text x="80" y="565" class="data">• Asynchronous, with feedback</text>
  <text x="80" y="580" class="data">• Long-running tasks, cancelable</text>

  <!-- Legend -->
  <rect x="600" y="500" width="180" height="80" fill="white" stroke="#ccc"/>
  <text x="610" y="520" class="subtitle">Legend</text>
  <rect x="610" y="530" width="15" height="15" class="topic"/>
  <text x="630" y="542" class="label">Topics</text>
  <rect x="610" y="550" width="15" height="15" class="service"/>
  <text x="630" y="562" class="label">Services</text>
  <rect x="610" y="570" width="15" height="15" class="action"/>
  <text x="630" y="582" class="label">Actions</text>
</svg>